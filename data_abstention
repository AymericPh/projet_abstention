{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "c1e00401",
   "metadata": {},
   "source": [
    "# I Lecture des fichiers excel"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "813353b5",
   "metadata": {},
   "source": [
    "## Première tentative de code de lecture"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "65c2b56d",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "from math import *\n",
    "import statistics"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "f542748b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: xlrd in /opt/anaconda3/lib/python3.8/site-packages (2.0.1)\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install xlrd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "96e3c13c",
   "metadata": {},
   "outputs": [],
   "source": [
    "import xlrd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "ddba00e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "pres_2012 = xlrd.open_workbook('participation_2012_datagouv.xls')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "319e05f3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Nombre de feuilles: 9\n",
      "Nombre de feuilles: ['France entière T1T2', 'Régions T1', 'Régions T2', 'Départements T1', 'Départements T2', 'Circo leg T1', 'Circo leg T2', 'Cantons T1', 'Cantons T2']\n"
     ]
    }
   ],
   "source": [
    "print(\"Nombre de feuilles: \"+str(pres_2012.nsheets))\n",
    "print(\"Nombre de feuilles: \"+str(pres_2012.sheet_names()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "6c01d0a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "dep_t1 = pres_2012.sheet_by_name(\"Départements T1\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "296604f3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Format de la feuille 1:\n",
      "Nom: Départements T1\n",
      "Nombre de lignes: 108\n",
      "Nombre de colonnes: 73\n"
     ]
    }
   ],
   "source": [
    "print(\"Format de la feuille 1:\")\n",
    "print(\"Nom: \"+str(dep_t1.name))\n",
    "print(\"Nombre de lignes: \"+str(dep_t1.nrows))\n",
    "print(\"Nombre de colonnes: \"+str(dep_t1.ncols))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "e606a557",
   "metadata": {},
   "outputs": [],
   "source": [
    "cols_dep_t1 = dep_t1.ncols\n",
    "rows = dep_t1.nrows"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0c37735b",
   "metadata": {},
   "source": [
    "N'aboutit pas (je n'arrive pas à me balader dans le fichier excel)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2e6fb93f",
   "metadata": {},
   "source": [
    "### Deuxième tentative de code de lecture moins puissant"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "53325cdf",
   "metadata": {},
   "source": [
    "On tire l'abstention par département pour la présidentielle de 2012 au tour 1 et au tour 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "eb6f5ffc",
   "metadata": {},
   "outputs": [],
   "source": [
    "presi_2012 = pd.read_excel('participation_2012_datagouv.xls')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "6b20f1a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "xls = pd.ExcelFile('participation_2012_datagouv.xls')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "e163f95c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['France entière T1T2',\n",
       " 'Régions T1',\n",
       " 'Régions T2',\n",
       " 'Départements T1',\n",
       " 'Départements T2',\n",
       " 'Circo leg T1',\n",
       " 'Circo leg T2',\n",
       " 'Cantons T1',\n",
       " 'Cantons T2']"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xls.sheet_names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "cc8a5169",
   "metadata": {},
   "outputs": [],
   "source": [
    "depa_t1_2012 = pd.read_excel('participation_2012_datagouv.xls', sheet_name = \"Départements T1\")\n",
    "depa_t2_2012 = pd.read_excel('participation_2012_datagouv.xls', sheet_name = \"Départements T2\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "8aaebd8f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code du département</th>\n",
       "      <th>Libellé du département</th>\n",
       "      <th>Inscrits</th>\n",
       "      <th>Abstentions_t2</th>\n",
       "      <th>% Abs/Ins_t2</th>\n",
       "      <th>Votants</th>\n",
       "      <th>% Vot/Ins</th>\n",
       "      <th>Blancs et nuls</th>\n",
       "      <th>% BlNuls/Ins</th>\n",
       "      <th>% BlNuls/Vot</th>\n",
       "      <th>...</th>\n",
       "      <th>Prénom</th>\n",
       "      <th>Voix</th>\n",
       "      <th>% Voix/Ins</th>\n",
       "      <th>% Voix/Exp</th>\n",
       "      <th>Sexe.1</th>\n",
       "      <th>Nom.1</th>\n",
       "      <th>Prénom.1</th>\n",
       "      <th>Voix.1</th>\n",
       "      <th>% Voix/Ins.1</th>\n",
       "      <th>% Voix/Exp.1</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>AIN</td>\n",
       "      <td>393866</td>\n",
       "      <td>67279.0</td>\n",
       "      <td>17.08</td>\n",
       "      <td>326587.0</td>\n",
       "      <td>82.92</td>\n",
       "      <td>19513.0</td>\n",
       "      <td>4.95</td>\n",
       "      <td>5.97</td>\n",
       "      <td>...</td>\n",
       "      <td>François</td>\n",
       "      <td>131333.0</td>\n",
       "      <td>33.34</td>\n",
       "      <td>42.77</td>\n",
       "      <td>M</td>\n",
       "      <td>SARKOZY</td>\n",
       "      <td>Nicolas</td>\n",
       "      <td>175741.0</td>\n",
       "      <td>44.62</td>\n",
       "      <td>57.23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>AISNE</td>\n",
       "      <td>376073</td>\n",
       "      <td>73997.0</td>\n",
       "      <td>19.68</td>\n",
       "      <td>302076.0</td>\n",
       "      <td>80.32</td>\n",
       "      <td>21056.0</td>\n",
       "      <td>5.60</td>\n",
       "      <td>6.97</td>\n",
       "      <td>...</td>\n",
       "      <td>François</td>\n",
       "      <td>147260.0</td>\n",
       "      <td>39.16</td>\n",
       "      <td>52.40</td>\n",
       "      <td>M</td>\n",
       "      <td>SARKOZY</td>\n",
       "      <td>Nicolas</td>\n",
       "      <td>133760.0</td>\n",
       "      <td>35.57</td>\n",
       "      <td>47.60</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>ALLIER</td>\n",
       "      <td>256211</td>\n",
       "      <td>45079.0</td>\n",
       "      <td>17.59</td>\n",
       "      <td>211132.0</td>\n",
       "      <td>82.41</td>\n",
       "      <td>14924.0</td>\n",
       "      <td>5.82</td>\n",
       "      <td>7.07</td>\n",
       "      <td>...</td>\n",
       "      <td>François</td>\n",
       "      <td>111615.0</td>\n",
       "      <td>43.56</td>\n",
       "      <td>56.89</td>\n",
       "      <td>M</td>\n",
       "      <td>SARKOZY</td>\n",
       "      <td>Nicolas</td>\n",
       "      <td>84593.0</td>\n",
       "      <td>33.02</td>\n",
       "      <td>43.11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>ALPES DE HAUTE PROVENCE</td>\n",
       "      <td>123895</td>\n",
       "      <td>20314.0</td>\n",
       "      <td>16.40</td>\n",
       "      <td>103581.0</td>\n",
       "      <td>83.60</td>\n",
       "      <td>6639.0</td>\n",
       "      <td>5.36</td>\n",
       "      <td>6.41</td>\n",
       "      <td>...</td>\n",
       "      <td>François</td>\n",
       "      <td>49498.0</td>\n",
       "      <td>39.95</td>\n",
       "      <td>51.06</td>\n",
       "      <td>M</td>\n",
       "      <td>SARKOZY</td>\n",
       "      <td>Nicolas</td>\n",
       "      <td>47444.0</td>\n",
       "      <td>38.29</td>\n",
       "      <td>48.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>HAUTES ALPES</td>\n",
       "      <td>106875</td>\n",
       "      <td>17470.0</td>\n",
       "      <td>16.35</td>\n",
       "      <td>89405.0</td>\n",
       "      <td>83.65</td>\n",
       "      <td>6025.0</td>\n",
       "      <td>5.64</td>\n",
       "      <td>6.74</td>\n",
       "      <td>...</td>\n",
       "      <td>François</td>\n",
       "      <td>42435.0</td>\n",
       "      <td>39.71</td>\n",
       "      <td>50.89</td>\n",
       "      <td>M</td>\n",
       "      <td>SARKOZY</td>\n",
       "      <td>Nicolas</td>\n",
       "      <td>40945.0</td>\n",
       "      <td>38.31</td>\n",
       "      <td>49.11</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "  Code du département   Libellé du département  Inscrits  Abstentions_t2  \\\n",
       "0                   1                      AIN    393866         67279.0   \n",
       "1                   2                    AISNE    376073         73997.0   \n",
       "2                   3                   ALLIER    256211         45079.0   \n",
       "3                   4  ALPES DE HAUTE PROVENCE    123895         20314.0   \n",
       "4                   5             HAUTES ALPES    106875         17470.0   \n",
       "\n",
       "   % Abs/Ins_t2   Votants  % Vot/Ins  Blancs et nuls  % BlNuls/Ins  \\\n",
       "0         17.08  326587.0      82.92         19513.0          4.95   \n",
       "1         19.68  302076.0      80.32         21056.0          5.60   \n",
       "2         17.59  211132.0      82.41         14924.0          5.82   \n",
       "3         16.40  103581.0      83.60          6639.0          5.36   \n",
       "4         16.35   89405.0      83.65          6025.0          5.64   \n",
       "\n",
       "   % BlNuls/Vot  ...    Prénom      Voix  % Voix/Ins % Voix/Exp Sexe.1  \\\n",
       "0          5.97  ...  François  131333.0       33.34      42.77      M   \n",
       "1          6.97  ...  François  147260.0       39.16      52.40      M   \n",
       "2          7.07  ...  François  111615.0       43.56      56.89      M   \n",
       "3          6.41  ...  François   49498.0       39.95      51.06      M   \n",
       "4          6.74  ...  François   42435.0       39.71      50.89      M   \n",
       "\n",
       "     Nom.1  Prénom.1    Voix.1  % Voix/Ins.1 % Voix/Exp.1  \n",
       "0  SARKOZY   Nicolas  175741.0         44.62        57.23  \n",
       "1  SARKOZY   Nicolas  133760.0         35.57        47.60  \n",
       "2  SARKOZY   Nicolas   84593.0         33.02        43.11  \n",
       "3  SARKOZY   Nicolas   47444.0         38.29        48.94  \n",
       "4  SARKOZY   Nicolas   40945.0         38.31        49.11  \n",
       "\n",
       "[5 rows x 25 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "depa_t2_2012.rename(columns = {'Abstentions' : 'Abstentions_t2', '% Abs/Ins' : '% Abs/Ins_t2'}, inplace = True)\n",
    "depa_t1_2012.rename(columns = {'Abstentions' : 'Abstentions_t1', '% Abs/Ins' : '% Abs/Ins_t1'}, inplace = True)\n",
    "depa_t2_2012.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "9565c1a7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code du département</th>\n",
       "      <th>Libellé du département</th>\n",
       "      <th>Abstentions_t1</th>\n",
       "      <th>% Abs/Ins_t1</th>\n",
       "      <th>Inscrits</th>\n",
       "      <th>Abstentions_t2</th>\n",
       "      <th>% Abs/Ins_t2</th>\n",
       "      <th>Année</th>\n",
       "      <th>Abs_nat_t1</th>\n",
       "      <th>Abs_nat_t2</th>\n",
       "      <th>Abs_nat</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>AIN</td>\n",
       "      <td>65996.0</td>\n",
       "      <td>16.76</td>\n",
       "      <td>393808.0</td>\n",
       "      <td>67279.0</td>\n",
       "      <td>17.08</td>\n",
       "      <td>2012</td>\n",
       "      <td>20.518015</td>\n",
       "      <td>19.661709</td>\n",
       "      <td>20.089862</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>AISNE</td>\n",
       "      <td>72928.0</td>\n",
       "      <td>19.39</td>\n",
       "      <td>376068.0</td>\n",
       "      <td>73997.0</td>\n",
       "      <td>19.68</td>\n",
       "      <td>2012</td>\n",
       "      <td>20.518015</td>\n",
       "      <td>19.661709</td>\n",
       "      <td>20.089862</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>ALLIER</td>\n",
       "      <td>45266.0</td>\n",
       "      <td>17.66</td>\n",
       "      <td>256275.0</td>\n",
       "      <td>45079.0</td>\n",
       "      <td>17.59</td>\n",
       "      <td>2012</td>\n",
       "      <td>20.518015</td>\n",
       "      <td>19.661709</td>\n",
       "      <td>20.089862</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>ALPES DE HAUTE PROVENCE</td>\n",
       "      <td>21034.0</td>\n",
       "      <td>16.97</td>\n",
       "      <td>123933.0</td>\n",
       "      <td>20314.0</td>\n",
       "      <td>16.40</td>\n",
       "      <td>2012</td>\n",
       "      <td>20.518015</td>\n",
       "      <td>19.661709</td>\n",
       "      <td>20.089862</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>HAUTES ALPES</td>\n",
       "      <td>18246.0</td>\n",
       "      <td>17.07</td>\n",
       "      <td>106865.0</td>\n",
       "      <td>17470.0</td>\n",
       "      <td>16.35</td>\n",
       "      <td>2012</td>\n",
       "      <td>20.518015</td>\n",
       "      <td>19.661709</td>\n",
       "      <td>20.089862</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Code du département   Libellé du département  Abstentions_t1  % Abs/Ins_t1  \\\n",
       "0                   1                      AIN         65996.0         16.76   \n",
       "1                   2                    AISNE         72928.0         19.39   \n",
       "2                   3                   ALLIER         45266.0         17.66   \n",
       "3                   4  ALPES DE HAUTE PROVENCE         21034.0         16.97   \n",
       "4                   5             HAUTES ALPES         18246.0         17.07   \n",
       "\n",
       "   Inscrits  Abstentions_t2  % Abs/Ins_t2  Année  Abs_nat_t1  Abs_nat_t2  \\\n",
       "0  393808.0         67279.0         17.08   2012   20.518015   19.661709   \n",
       "1  376068.0         73997.0         19.68   2012   20.518015   19.661709   \n",
       "2  256275.0         45079.0         17.59   2012   20.518015   19.661709   \n",
       "3  123933.0         20314.0         16.40   2012   20.518015   19.661709   \n",
       "4  106865.0         17470.0         16.35   2012   20.518015   19.661709   \n",
       "\n",
       "     Abs_nat  \n",
       "0  20.089862  \n",
       "1  20.089862  \n",
       "2  20.089862  \n",
       "3  20.089862  \n",
       "4  20.089862  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1_2012 = depa_t1_2012[['Code du département', 'Libellé du département', 'Abstentions_t1', '% Abs/Ins_t1', 'Inscrits']]\n",
    "df2_2012 = depa_t2_2012[['Abstentions_t2', '% Abs/Ins_t2']]\n",
    "depa_t1t2_2012 = pd.concat([df1_2012,df2_2012], axis = 1)\n",
    "depa_t1t2_2012['Année'] = 2012\n",
    "depa_t1t2_2012['Abs_nat_t1'] = (depa_t1t2_2012['Abstentions_t1'].sum()*100) / depa_t1t2_2012['Inscrits'].sum()\n",
    "depa_t1t2_2012['Abs_nat_t2'] = (depa_t1t2_2012['Abstentions_t2'].sum()*100) / depa_t1t2_2012['Inscrits'].sum()\n",
    "depa_t1t2_2012['Abs_nat'] = statistics.mean([depa_t1t2_2012['Abs_nat_t1'][0], depa_t1t2_2012['Abs_nat_t2'][0]])\n",
    "depa_t1t2_2012.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a3b4cd4f",
   "metadata": {},
   "source": [
    "On tire l'abstention de 2017 au tour 1 et au tour 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "09fa10e8",
   "metadata": {},
   "outputs": [],
   "source": [
    "pres_t1_2017 = pd.read_excel('participation_2017_tour1_datagouv.xls')\n",
    "pres_t2_2017 = pd.read_excel('participation_2017_tour2_datagouv.xls')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "60853e32",
   "metadata": {},
   "outputs": [],
   "source": [
    "xls_1 = pd.ExcelFile('participation_2017_tour1_datagouv.xls')\n",
    "xls_2 = pd.ExcelFile('participation_2017_tour2_datagouv.xls')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "fb9e0d68",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['FE Metro OM Tour 1', 'Régions Tour 1', 'Départements Tour 1', 'Circo. Leg. Tour 1', 'Canton Tour 1']\n",
      "['FE Metro OM Tour 2', 'Régions Tour 2', 'Départements Tour 2', 'Circo. Leg. Tour 2', 'Canton Tour 2']\n"
     ]
    }
   ],
   "source": [
    "print(xls_1.sheet_names)\n",
    "print(xls_2.sheet_names)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "4cdea0c0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code du département</th>\n",
       "      <th>Libellé du département</th>\n",
       "      <th>Inscrits</th>\n",
       "      <th>Abstentions</th>\n",
       "      <th>% Abs/Ins</th>\n",
       "      <th>Votants</th>\n",
       "      <th>% Vot/Ins</th>\n",
       "      <th>Blancs</th>\n",
       "      <th>% Blancs/Ins</th>\n",
       "      <th>% Blancs/Vot</th>\n",
       "      <th>...</th>\n",
       "      <th>Prénom.9</th>\n",
       "      <th>Voix.9</th>\n",
       "      <th>% Voix/Ins.9</th>\n",
       "      <th>% Voix/Exp.9</th>\n",
       "      <th>Sexe.10</th>\n",
       "      <th>Nom.10</th>\n",
       "      <th>Prénom.10</th>\n",
       "      <th>Voix.10</th>\n",
       "      <th>% Voix/Ins.10</th>\n",
       "      <th>% Voix/Exp.10</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Ain</td>\n",
       "      <td>415886</td>\n",
       "      <td>81507</td>\n",
       "      <td>19.60</td>\n",
       "      <td>334379</td>\n",
       "      <td>80.40</td>\n",
       "      <td>6342</td>\n",
       "      <td>1.52</td>\n",
       "      <td>1.90</td>\n",
       "      <td>...</td>\n",
       "      <td>Nathalie</td>\n",
       "      <td>1842</td>\n",
       "      <td>0.44</td>\n",
       "      <td>0.57</td>\n",
       "      <td>M</td>\n",
       "      <td>CHEMINADE</td>\n",
       "      <td>Jacques</td>\n",
       "      <td>595</td>\n",
       "      <td>0.14</td>\n",
       "      <td>0.18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Aisne</td>\n",
       "      <td>375752</td>\n",
       "      <td>80183</td>\n",
       "      <td>21.34</td>\n",
       "      <td>295569</td>\n",
       "      <td>78.66</td>\n",
       "      <td>5047</td>\n",
       "      <td>1.34</td>\n",
       "      <td>1.71</td>\n",
       "      <td>...</td>\n",
       "      <td>François</td>\n",
       "      <td>2171</td>\n",
       "      <td>0.58</td>\n",
       "      <td>0.75</td>\n",
       "      <td>M</td>\n",
       "      <td>CHEMINADE</td>\n",
       "      <td>Jacques</td>\n",
       "      <td>536</td>\n",
       "      <td>0.14</td>\n",
       "      <td>0.19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Allier</td>\n",
       "      <td>253508</td>\n",
       "      <td>54275</td>\n",
       "      <td>21.41</td>\n",
       "      <td>199233</td>\n",
       "      <td>78.59</td>\n",
       "      <td>4335</td>\n",
       "      <td>1.71</td>\n",
       "      <td>2.18</td>\n",
       "      <td>...</td>\n",
       "      <td>François</td>\n",
       "      <td>1422</td>\n",
       "      <td>0.56</td>\n",
       "      <td>0.74</td>\n",
       "      <td>M</td>\n",
       "      <td>CHEMINADE</td>\n",
       "      <td>Jacques</td>\n",
       "      <td>353</td>\n",
       "      <td>0.14</td>\n",
       "      <td>0.18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Alpes-de-Haute-Provence</td>\n",
       "      <td>126578</td>\n",
       "      <td>24323</td>\n",
       "      <td>19.22</td>\n",
       "      <td>102255</td>\n",
       "      <td>80.78</td>\n",
       "      <td>1808</td>\n",
       "      <td>1.43</td>\n",
       "      <td>1.77</td>\n",
       "      <td>...</td>\n",
       "      <td>Nathalie</td>\n",
       "      <td>521</td>\n",
       "      <td>0.41</td>\n",
       "      <td>0.52</td>\n",
       "      <td>M</td>\n",
       "      <td>CHEMINADE</td>\n",
       "      <td>Jacques</td>\n",
       "      <td>205</td>\n",
       "      <td>0.16</td>\n",
       "      <td>0.21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Hautes-Alpes</td>\n",
       "      <td>109907</td>\n",
       "      <td>20821</td>\n",
       "      <td>18.94</td>\n",
       "      <td>89086</td>\n",
       "      <td>81.06</td>\n",
       "      <td>1541</td>\n",
       "      <td>1.40</td>\n",
       "      <td>1.73</td>\n",
       "      <td>...</td>\n",
       "      <td>Nathalie</td>\n",
       "      <td>411</td>\n",
       "      <td>0.37</td>\n",
       "      <td>0.47</td>\n",
       "      <td>M</td>\n",
       "      <td>CHEMINADE</td>\n",
       "      <td>Jacques</td>\n",
       "      <td>165</td>\n",
       "      <td>0.15</td>\n",
       "      <td>0.19</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 82 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "  Code du département   Libellé du département  Inscrits  Abstentions  \\\n",
       "0                   1                      Ain    415886        81507   \n",
       "1                   2                    Aisne    375752        80183   \n",
       "2                   3                   Allier    253508        54275   \n",
       "3                   4  Alpes-de-Haute-Provence    126578        24323   \n",
       "4                   5             Hautes-Alpes    109907        20821   \n",
       "\n",
       "   % Abs/Ins  Votants  % Vot/Ins  Blancs  % Blancs/Ins  % Blancs/Vot  ...  \\\n",
       "0      19.60   334379      80.40    6342          1.52          1.90  ...   \n",
       "1      21.34   295569      78.66    5047          1.34          1.71  ...   \n",
       "2      21.41   199233      78.59    4335          1.71          2.18  ...   \n",
       "3      19.22   102255      80.78    1808          1.43          1.77  ...   \n",
       "4      18.94    89086      81.06    1541          1.40          1.73  ...   \n",
       "\n",
       "   Prénom.9  Voix.9  % Voix/Ins.9  % Voix/Exp.9  Sexe.10     Nom.10 Prénom.10  \\\n",
       "0  Nathalie    1842          0.44          0.57        M  CHEMINADE   Jacques   \n",
       "1  François    2171          0.58          0.75        M  CHEMINADE   Jacques   \n",
       "2  François    1422          0.56          0.74        M  CHEMINADE   Jacques   \n",
       "3  Nathalie     521          0.41          0.52        M  CHEMINADE   Jacques   \n",
       "4  Nathalie     411          0.37          0.47        M  CHEMINADE   Jacques   \n",
       "\n",
       "  Voix.10 % Voix/Ins.10  % Voix/Exp.10  \n",
       "0     595          0.14           0.18  \n",
       "1     536          0.14           0.19  \n",
       "2     353          0.14           0.18  \n",
       "3     205          0.16           0.21  \n",
       "4     165          0.15           0.19  \n",
       "\n",
       "[5 rows x 82 columns]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "depa_t1_2017 = pd.read_excel('participation_2017_tour1_datagouv.xls', sheet_name = \"Départements Tour 1\")\n",
    "depa_t2_2017 = pd.read_excel('participation_2017_tour2_datagouv.xls', sheet_name = \"Départements Tour 2\")\n",
    "depa_t1_2017.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "11cece1f",
   "metadata": {},
   "outputs": [],
   "source": [
    "depa_t2_2017.rename(columns = {'Abstentions' : 'Abstentions_t2', '% Abs/Ins' : '% Abs/Ins_t2'}, inplace = True)\n",
    "depa_t1_2017.rename(columns = {'Abstentions' : 'Abstentions_t1', '% Abs/Ins' : '% Abs/Ins_t1'}, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "00c95970",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code du département</th>\n",
       "      <th>Libellé du département</th>\n",
       "      <th>Abstentions_t1</th>\n",
       "      <th>% Abs/Ins_t1</th>\n",
       "      <th>Inscrits</th>\n",
       "      <th>Abstentions_t2</th>\n",
       "      <th>% Abs/Ins_t2</th>\n",
       "      <th>Année</th>\n",
       "      <th>Abs_nat_t1</th>\n",
       "      <th>Abs_nat_t2</th>\n",
       "      <th>Abs_nat</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Ain</td>\n",
       "      <td>81507</td>\n",
       "      <td>19.60</td>\n",
       "      <td>415886</td>\n",
       "      <td>93130</td>\n",
       "      <td>22.39</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Aisne</td>\n",
       "      <td>80183</td>\n",
       "      <td>21.34</td>\n",
       "      <td>375752</td>\n",
       "      <td>90745</td>\n",
       "      <td>24.15</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Allier</td>\n",
       "      <td>54275</td>\n",
       "      <td>21.41</td>\n",
       "      <td>253508</td>\n",
       "      <td>59294</td>\n",
       "      <td>23.39</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Alpes-de-Haute-Provence</td>\n",
       "      <td>24323</td>\n",
       "      <td>19.22</td>\n",
       "      <td>126578</td>\n",
       "      <td>29255</td>\n",
       "      <td>23.13</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Hautes-Alpes</td>\n",
       "      <td>20821</td>\n",
       "      <td>18.94</td>\n",
       "      <td>109907</td>\n",
       "      <td>24895</td>\n",
       "      <td>22.65</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Code du département   Libellé du département  Abstentions_t1  % Abs/Ins_t1  \\\n",
       "0                   1                      Ain           81507         19.60   \n",
       "1                   2                    Aisne           80183         21.34   \n",
       "2                   3                   Allier           54275         21.41   \n",
       "3                   4  Alpes-de-Haute-Provence           24323         19.22   \n",
       "4                   5             Hautes-Alpes           20821         18.94   \n",
       "\n",
       "   Inscrits  Abstentions_t2  % Abs/Ins_t2  Année  Abs_nat_t1  Abs_nat_t2  \\\n",
       "0    415886           93130         22.39   2017   22.231967   25.432557   \n",
       "1    375752           90745         24.15   2017   22.231967   25.432557   \n",
       "2    253508           59294         23.39   2017   22.231967   25.432557   \n",
       "3    126578           29255         23.13   2017   22.231967   25.432557   \n",
       "4    109907           24895         22.65   2017   22.231967   25.432557   \n",
       "\n",
       "     Abs_nat  \n",
       "0  23.832262  \n",
       "1  23.832262  \n",
       "2  23.832262  \n",
       "3  23.832262  \n",
       "4  23.832262  "
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1_2017 = depa_t1_2017[['Code du département', 'Libellé du département', 'Abstentions_t1', '% Abs/Ins_t1', 'Inscrits']]\n",
    "df2_2017 = depa_t2_2017[['Abstentions_t2', '% Abs/Ins_t2']]\n",
    "depa_t1t2_2017 = pd.concat([df1_2017,df2_2017], axis = 1)\n",
    "depa_t1t2_2017['Année'] = 2017\n",
    "depa_t1t2_2017['Abs_nat_t1'] = (depa_t1t2_2017['Abstentions_t1'].sum()*100) / depa_t1t2_2017['Inscrits'].sum()\n",
    "depa_t1t2_2017['Abs_nat_t2'] = (depa_t1t2_2017['Abstentions_t2'].sum()*100) / depa_t1t2_2017['Inscrits'].sum()\n",
    "depa_t1t2_2017['Abs_nat'] = statistics.mean([depa_t1t2_2017['Abs_nat_t1'][0], depa_t1t2_2017['Abs_nat_t2'][0]])\n",
    "depa_t1t2_2017.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3723b204",
   "metadata": {},
   "source": [
    "On tire l'abstention de 2007 au tour 1 et au tour 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "d1db296a",
   "metadata": {},
   "outputs": [],
   "source": [
    "pres_2007 = pd.read_excel('participation_2007_datagouv.xls')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "f0605dce",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['France entière T1T2',\n",
       " 'Régions T1',\n",
       " 'Régions T2',\n",
       " 'Départements T1',\n",
       " 'Départements T2',\n",
       " 'Circo leg T1',\n",
       " 'Circo leg T2',\n",
       " 'Cantons T1',\n",
       " 'Cantons T2']"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "xls = pd.ExcelFile('participation_2007_datagouv.xls')\n",
    "xls.sheet_names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "29d5f726",
   "metadata": {},
   "outputs": [],
   "source": [
    "depa_t1_2007 = pd.read_excel('participation_2007_datagouv.xls', sheet_name = \"Départements T1\")\n",
    "depa_t2_2007 = pd.read_excel('participation_2007_datagouv.xls', sheet_name = \"Départements T2\")\n",
    "depa_t2_2007.rename(columns = {'Abstentions' : 'Abstentions_t2', '% Abs/Ins' : '% Abs/Ins_t2'}, inplace = True)\n",
    "depa_t1_2007.rename(columns = {'Abstentions' : 'Abstentions_t1', '% Abs/Ins' : '% Abs/Ins_t1'}, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "34c92b12",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code du département</th>\n",
       "      <th>Libellé du département</th>\n",
       "      <th>Abstentions_t1</th>\n",
       "      <th>% Abs/Ins_t1</th>\n",
       "      <th>Inscrits</th>\n",
       "      <th>Abstentions_t2</th>\n",
       "      <th>% Abs/Ins_t2</th>\n",
       "      <th>Année</th>\n",
       "      <th>Abs_nat_t1</th>\n",
       "      <th>Abs_nat_t2</th>\n",
       "      <th>Abs_nat</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>AIN</td>\n",
       "      <td>52040</td>\n",
       "      <td>13,96</td>\n",
       "      <td>372899</td>\n",
       "      <td>53428</td>\n",
       "      <td>14,33</td>\n",
       "      <td>2007</td>\n",
       "      <td>16.231464</td>\n",
       "      <td>16.033898</td>\n",
       "      <td>16.132681</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>AISNE</td>\n",
       "      <td>61974</td>\n",
       "      <td>16,42</td>\n",
       "      <td>377475</td>\n",
       "      <td>60071</td>\n",
       "      <td>15,91</td>\n",
       "      <td>2007</td>\n",
       "      <td>16.231464</td>\n",
       "      <td>16.033898</td>\n",
       "      <td>16.132681</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>ALLIER</td>\n",
       "      <td>38012</td>\n",
       "      <td>14,65</td>\n",
       "      <td>259537</td>\n",
       "      <td>38826</td>\n",
       "      <td>14,96</td>\n",
       "      <td>2007</td>\n",
       "      <td>16.231464</td>\n",
       "      <td>16.033898</td>\n",
       "      <td>16.132681</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>ALPES DE HAUTE PROVENCE</td>\n",
       "      <td>16143</td>\n",
       "      <td>13,57</td>\n",
       "      <td>118936</td>\n",
       "      <td>15140</td>\n",
       "      <td>12,73</td>\n",
       "      <td>2007</td>\n",
       "      <td>16.231464</td>\n",
       "      <td>16.033898</td>\n",
       "      <td>16.132681</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>HAUTES ALPES</td>\n",
       "      <td>14428</td>\n",
       "      <td>14,01</td>\n",
       "      <td>102955</td>\n",
       "      <td>13349</td>\n",
       "      <td>12,95</td>\n",
       "      <td>2007</td>\n",
       "      <td>16.231464</td>\n",
       "      <td>16.033898</td>\n",
       "      <td>16.132681</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Code du département   Libellé du département  Abstentions_t1 % Abs/Ins_t1  \\\n",
       "0                   1                      AIN           52040        13,96   \n",
       "1                   2                    AISNE           61974        16,42   \n",
       "2                   3                   ALLIER           38012        14,65   \n",
       "3                   4  ALPES DE HAUTE PROVENCE           16143        13,57   \n",
       "4                   5             HAUTES ALPES           14428        14,01   \n",
       "\n",
       "   Inscrits  Abstentions_t2 % Abs/Ins_t2  Année  Abs_nat_t1  Abs_nat_t2  \\\n",
       "0    372899           53428        14,33   2007   16.231464   16.033898   \n",
       "1    377475           60071        15,91   2007   16.231464   16.033898   \n",
       "2    259537           38826        14,96   2007   16.231464   16.033898   \n",
       "3    118936           15140        12,73   2007   16.231464   16.033898   \n",
       "4    102955           13349        12,95   2007   16.231464   16.033898   \n",
       "\n",
       "     Abs_nat  \n",
       "0  16.132681  \n",
       "1  16.132681  \n",
       "2  16.132681  \n",
       "3  16.132681  \n",
       "4  16.132681  "
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1_2007 = depa_t1_2007[['Code du département', 'Libellé du département', 'Abstentions_t1', '% Abs/Ins_t1', 'Inscrits']]\n",
    "df2_2007 = depa_t2_2007[['Abstentions_t2', '% Abs/Ins_t2']]\n",
    "depa_t1t2_2007 = pd.concat([df1_2007,df2_2007], axis = 1)\n",
    "depa_t1t2_2007['Année'] = 2007\n",
    "depa_t1t2_2007['Abs_nat_t1'] = (depa_t1t2_2007['Abstentions_t1'].sum()*100) / depa_t1t2_2007['Inscrits'].sum()\n",
    "depa_t1t2_2007['Abs_nat_t2'] = (depa_t1t2_2007['Abstentions_t2'].sum()*100) / depa_t1t2_2007['Inscrits'].sum()\n",
    "depa_t1t2_2007['Abs_nat'] = statistics.mean([depa_t1t2_2007['Abs_nat_t1'][0], depa_t1t2_2007['Abs_nat_t2'][0]])\n",
    "depa_t1t2_2007.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "954fef27",
   "metadata": {},
   "source": [
    "On tire l'abstention de 2002 au tour 1 et au tour 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "17653842",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['France entière T1T2',\n",
       " 'Régions T1',\n",
       " 'Régions T2',\n",
       " 'Départements T1',\n",
       " 'Départements T2',\n",
       " 'Circo leg T1',\n",
       " 'Circo leg T2',\n",
       " 'Cantons T1',\n",
       " 'Cantons T2']"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pres_2002 = pd.read_excel('participation_2002_datagouv.xls')\n",
    "xls = pd.ExcelFile('participation_2002_datagouv.xls')\n",
    "xls.sheet_names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "222c178b",
   "metadata": {},
   "outputs": [],
   "source": [
    "depa_t1_2002 = pd.read_excel('participation_2002_datagouv.xls', sheet_name = \"Départements T1\")\n",
    "depa_t2_2002 = pd.read_excel('participation_2002_datagouv.xls', sheet_name = \"Départements T2\")\n",
    "depa_t2_2002.rename(columns = {'Abstentions' : 'Abstentions_t2', '% Abs/Ins' : '% Abs/Ins_t2'}, inplace = True)\n",
    "depa_t1_2002.rename(columns = {'Abstentions' : 'Abstentions_t1', '% Abs/Ins' : '% Abs/Ins_t1'}, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "0921809f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code du département</th>\n",
       "      <th>Libellé du département</th>\n",
       "      <th>Abstentions_t1</th>\n",
       "      <th>% Abs/Ins_t1</th>\n",
       "      <th>Inscrits</th>\n",
       "      <th>Abstentions_t2</th>\n",
       "      <th>% Abs/Ins_t2</th>\n",
       "      <th>Année</th>\n",
       "      <th>Abs_nat_t1</th>\n",
       "      <th>Abs_nat_t2</th>\n",
       "      <th>Abs_nat</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>AIN</td>\n",
       "      <td>89002.0</td>\n",
       "      <td>26.31</td>\n",
       "      <td>338220</td>\n",
       "      <td>64394.0</td>\n",
       "      <td>19.04</td>\n",
       "      <td>2002</td>\n",
       "      <td>14.199823</td>\n",
       "      <td>10.145453</td>\n",
       "      <td>12.172638</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>AISNE</td>\n",
       "      <td>96157.0</td>\n",
       "      <td>26.21</td>\n",
       "      <td>366810</td>\n",
       "      <td>71788.0</td>\n",
       "      <td>19.57</td>\n",
       "      <td>2002</td>\n",
       "      <td>14.199823</td>\n",
       "      <td>10.145453</td>\n",
       "      <td>12.172638</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>ALLIER</td>\n",
       "      <td>67066.0</td>\n",
       "      <td>26.19</td>\n",
       "      <td>256113</td>\n",
       "      <td>48994.0</td>\n",
       "      <td>19.13</td>\n",
       "      <td>2002</td>\n",
       "      <td>14.199823</td>\n",
       "      <td>10.145453</td>\n",
       "      <td>12.172638</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>ALPES DE HAUTE PROVENCE</td>\n",
       "      <td>26555.0</td>\n",
       "      <td>24.38</td>\n",
       "      <td>108943</td>\n",
       "      <td>18812.0</td>\n",
       "      <td>17.27</td>\n",
       "      <td>2002</td>\n",
       "      <td>14.199823</td>\n",
       "      <td>10.145453</td>\n",
       "      <td>12.172638</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>HAUTES ALPES</td>\n",
       "      <td>23051.0</td>\n",
       "      <td>24.24</td>\n",
       "      <td>95100</td>\n",
       "      <td>16533.0</td>\n",
       "      <td>17.39</td>\n",
       "      <td>2002</td>\n",
       "      <td>14.199823</td>\n",
       "      <td>10.145453</td>\n",
       "      <td>12.172638</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Code du département   Libellé du département  Abstentions_t1  % Abs/Ins_t1  \\\n",
       "0                   1                      AIN         89002.0         26.31   \n",
       "1                   2                    AISNE         96157.0         26.21   \n",
       "2                   3                   ALLIER         67066.0         26.19   \n",
       "3                   4  ALPES DE HAUTE PROVENCE         26555.0         24.38   \n",
       "4                   5             HAUTES ALPES         23051.0         24.24   \n",
       "\n",
       "   Inscrits  Abstentions_t2  % Abs/Ins_t2  Année  Abs_nat_t1  Abs_nat_t2  \\\n",
       "0    338220         64394.0         19.04   2002   14.199823   10.145453   \n",
       "1    366810         71788.0         19.57   2002   14.199823   10.145453   \n",
       "2    256113         48994.0         19.13   2002   14.199823   10.145453   \n",
       "3    108943         18812.0         17.27   2002   14.199823   10.145453   \n",
       "4     95100         16533.0         17.39   2002   14.199823   10.145453   \n",
       "\n",
       "     Abs_nat  \n",
       "0  12.172638  \n",
       "1  12.172638  \n",
       "2  12.172638  \n",
       "3  12.172638  \n",
       "4  12.172638  "
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1_2002 = depa_t1_2002[['Code du département', 'Libellé du département', 'Abstentions_t1', '% Abs/Ins_t1', 'Inscrits']]\n",
    "df2_2002 = depa_t2_2002[['Abstentions_t2', '% Abs/Ins_t2']]\n",
    "depa_t1t2_2002 = pd.concat([df1_2002,df2_2002], axis = 1)\n",
    "depa_t1t2_2002['Année'] = 2002\n",
    "depa_t1t2_2002['Abs_nat_t1'] = (depa_t1t2_2002['Abstentions_t1'].sum()*100) / depa_t1t2_2002['Inscrits'].sum()\n",
    "depa_t1t2_2002['Abs_nat_t2'] = (depa_t1t2_2002['Abstentions_t2'].sum()*100) / depa_t1t2_2002['Inscrits'].sum()\n",
    "depa_t1t2_2002['Abs_nat'] = statistics.mean([depa_t1t2_2002['Abs_nat_t1'][0], depa_t1t2_2002['Abs_nat_t2'][0]])\n",
    "depa_t1t2_2002.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8f5fd240",
   "metadata": {},
   "source": [
    "On concatène les 4 datasets "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "48441141",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code du département</th>\n",
       "      <th>Libellé du département</th>\n",
       "      <th>Abstentions_t1</th>\n",
       "      <th>% Abs/Ins_t1</th>\n",
       "      <th>Inscrits</th>\n",
       "      <th>Abstentions_t2</th>\n",
       "      <th>% Abs/Ins_t2</th>\n",
       "      <th>Année</th>\n",
       "      <th>Abs_nat_t1</th>\n",
       "      <th>Abs_nat_t2</th>\n",
       "      <th>Abs_nat</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Ain</td>\n",
       "      <td>81507.0</td>\n",
       "      <td>19.6</td>\n",
       "      <td>415886.0</td>\n",
       "      <td>93130.0</td>\n",
       "      <td>22.39</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>68</td>\n",
       "      <td>Haut-Rhin</td>\n",
       "      <td>110496.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>526190.0</td>\n",
       "      <td>128800.0</td>\n",
       "      <td>24.48</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>79</td>\n",
       "      <td>Deux-Sèvres</td>\n",
       "      <td>51156.0</td>\n",
       "      <td>18.78</td>\n",
       "      <td>272385.0</td>\n",
       "      <td>57585.0</td>\n",
       "      <td>21.14</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>78</td>\n",
       "      <td>Yvelines</td>\n",
       "      <td>177485.0</td>\n",
       "      <td>18.66</td>\n",
       "      <td>951148.0</td>\n",
       "      <td>225177.0</td>\n",
       "      <td>23.68</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>77</td>\n",
       "      <td>Seine-et-Marne</td>\n",
       "      <td>183302.0</td>\n",
       "      <td>20.79</td>\n",
       "      <td>881558.0</td>\n",
       "      <td>228009.0</td>\n",
       "      <td>25.88</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Code du département Libellé du département  Abstentions_t1 % Abs/Ins_t1  \\\n",
       "0                   1                    Ain         81507.0         19.6   \n",
       "1                  68              Haut-Rhin        110496.0         21.0   \n",
       "2                  79            Deux-Sèvres         51156.0        18.78   \n",
       "3                  78               Yvelines        177485.0        18.66   \n",
       "4                  77         Seine-et-Marne        183302.0        20.79   \n",
       "\n",
       "   Inscrits  Abstentions_t2 % Abs/Ins_t2  Année  Abs_nat_t1  Abs_nat_t2  \\\n",
       "0  415886.0         93130.0        22.39   2017   22.231967   25.432557   \n",
       "1  526190.0        128800.0        24.48   2017   22.231967   25.432557   \n",
       "2  272385.0         57585.0        21.14   2017   22.231967   25.432557   \n",
       "3  951148.0        225177.0        23.68   2017   22.231967   25.432557   \n",
       "4  881558.0        228009.0        25.88   2017   22.231967   25.432557   \n",
       "\n",
       "     Abs_nat  \n",
       "0  23.832262  \n",
       "1  23.832262  \n",
       "2  23.832262  \n",
       "3  23.832262  \n",
       "4  23.832262  "
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dep_abs = pd.concat([depa_t1t2_2017, depa_t1t2_2012, depa_t1t2_2007, depa_t1t2_2002], axis = 0)\n",
    "dep_abs.sort_values(by = 'Année', ascending = False, inplace = True)\n",
    "dep_abs.reset_index(inplace = True)\n",
    "dep_abs.drop('index', axis = 1, inplace = True)\n",
    "dep_abs.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "215a30dd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([19.6, 21.0, 18.78, 18.66, 20.79, 20.11, 16.15, 21.53, 20.23, 18.15,\n",
       "       21.35, 19.52, 21.55, 20.1, 21.51, 21.27, 19.29, 19.38, 20.25,\n",
       "       21.48, 18.37, 20.15, 23.11, 22.24, 23.63, 16.66, 17.34, 17.79,\n",
       "       21.28, 20.03, 21.34, 55.72, 67.76, 36.07, 45.07, 61.06, 51.86,\n",
       "       56.43, 41.32, 65.65, 60.12, 59.96, 22.94, 20.89, 27.51, 17.91,\n",
       "       19.8, 22.71, 21.8, 19.95, 19.01, 20.24, 16.11, 19.68, 16.37, 19.39,\n",
       "       20.68, 18.32, 21.39, 15.71, 19.04, 32.76, 31.03, 18.51, 22.23,\n",
       "       20.22, 21.15, 18.02, 19.23, 21.87, 16.67, 19.27, 19.11, 18.22,\n",
       "       22.68, 18.7, 21.25, 18.94, 19.22, 21.45, 19.81, 21.41, 20.06,\n",
       "       17.86, 21.29, 18.52, 17.04, 16.72, 19.43, 16.39, 18.56, 21.31,\n",
       "       18.88, 19.44, 19.19, 19.93, 19.94, 18.84, 15.89, 17.47, 19.91,\n",
       "       15.98, 20.49, 18.69, 20.6, 16.1, 21.18, 22.09, 19.09, 19.85, 18.89,\n",
       "       16.91, 17.83, 18.92, 16.84, 18.42, 15.49, 20.17, 18.2, 16.77,\n",
       "       17.75, 15.93, 20.13, 16.65, 19.07, 22.12, 19.24, 21.85, 14.73,\n",
       "       26.54, 15.0, 19.42, 60.93, 63.51, 27.9, 44.55, 50.65, 44.62, 51.32,\n",
       "       34.41, 49.05, 47.58, 47.49, 23.03, 22.5, 20.05, 20.58, 20.82,\n",
       "       19.37, 19.26, 17.99, 17.31, 14.67, 17.94, 18.27, nan, 15.59, 19.58,\n",
       "       17.77, 14.29, 16.99, 25.72, 25.74, 14.64, 19.62, 18.11, 17.89,\n",
       "       16.82, 14.7, 17.2, 16.51, 18.64, 15.9, 20.61, 15.85, 17.07, 16.97,\n",
       "       17.66, 15.16, 16.76, 16.87, 16.2, 18.49, 16.94, 15.62, 14.79,\n",
       "       16.73, 13.86, 15.76, 15.46, 17.51, 17.19, 20.95, 16.42, 14.19,\n",
       "       17.4, 15.84, 17.15, 16.53, 19.0, 17.84, 15.35, 18.03, 17.28,\n",
       "       '17,16', '14,61', '16,56', '12,58', '14,54', '13,78', '15,03',\n",
       "       '16,31', '14,28', '13,61', '17,42', '16,91', '14,99', '13,32',\n",
       "       '12,82', '12,97', '14,14', '16,49', '19,18', '16,33', '17,86',\n",
       "       '12,63', '15,69', '14,84', '13,06', '11,58', '11,98', '12,67',\n",
       "       '59,70', '35,45', '36,91', '30,88', '37,29', '53,74', '27,39',\n",
       "       '41,24', '41,01', '40,86', '14,24', '14,44', '16,98', '12,92',\n",
       "       '15,67', '16,21', '13,24', '14,23', '11,87', '14,69', '16,53',\n",
       "       '16,14', '13,00', '17,05', '14,18', '11,68', '14,37', '24,57',\n",
       "       '24,41', '12,99', '17,57', '15,17', '15,24', '14,20', '16,18',\n",
       "       '11,79', '13,55', '16,38', '12,85', '17,85', '13,09', '16,96',\n",
       "       '14,01', '13,57', '14,65', '16,42', '13,96', '13,76', '13,81',\n",
       "       '15,57', '12,13', '12,24', '12,78', '10,98', '15,51', '12,91',\n",
       "       '14,63', '14,72', '12,32', '13,85', '13,69', '11,63', '16,05',\n",
       "       '12,61', '13,80', '12,49', '18,60', '12,17', '15,29', '14,36',\n",
       "       '14,11', 26.43, 25.8, 23.69, 27.02, 27.75, 29.81, 27.3, 26.11,\n",
       "       26.46, 32.37, 31.2, 26.22, 24.92, 27.13, 27.12, 25.37, 26.86,\n",
       "       24.43, 26.18, 28.88, 27.74, 31.05, 25.06, 26.78, 25.6, 62.73,\n",
       "       24.28, 33.15, 25.18, 35.56, 58.03, 47.93, 50.74, 58.78, 43.68,\n",
       "       53.24, 64.65, 65.87, 32.36, 35.52, 22.13, 32.27, 31.82, 23.62,\n",
       "       26.48, 26.82, 22.88, 24.72, 23.94, 24.44, 27.98, 29.02, 25.76,\n",
       "       27.82, 23.73, 23.53, 24.48, 42.13, 40.54, 20.37, 26.65, 26.95,\n",
       "       26.39, 25.25, 26.8, 21.79, 24.01, 26.23, 23.99, 27.97, 23.76,\n",
       "       30.75, 24.24, 24.38, 26.19, 26.21, 26.31, 27.44, 23.41, 29.32,\n",
       "       25.33, 26.1, 24.89, 22.63, 22.01, 25.07, 25.98, 23.97, 27.2, 24.94,\n",
       "       25.11, 24.14, 26.09, 25.66, 28.33, 22.7, 24.08, 25.69, 25.02],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dep_abs['% Abs/Ins_t1'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "fba8f4bc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0     19.6\n",
       "1     21.0\n",
       "2    18.78\n",
       "3    18.66\n",
       "4    20.79\n",
       "Name: % Abs/Ins_t1, dtype: object"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dep_abs['% Abs/Ins_t1'].head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "f7f28750",
   "metadata": {},
   "outputs": [],
   "source": [
    "stripped_virgule_t1 = dep_abs['% Abs/Ins_t1'].astype('str')\n",
    "stripped_virgule_t1 = stripped_virgule_t1.str.replace(',','.')\n",
    "dep_abs['% Abs/Ins_t1'] = stripped_virgule_t1.astype('float')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "b2239dc1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 428 entries, 0 to 427\n",
      "Data columns (total 11 columns):\n",
      " #   Column                  Non-Null Count  Dtype  \n",
      "---  ------                  --------------  -----  \n",
      " 0   Code du département     426 non-null    object \n",
      " 1   Libellé du département  426 non-null    object \n",
      " 2   Abstentions_t1          426 non-null    float64\n",
      " 3   % Abs/Ins_t1            426 non-null    float64\n",
      " 4   Inscrits                427 non-null    float64\n",
      " 5   Abstentions_t2          426 non-null    float64\n",
      " 6   % Abs/Ins_t2            426 non-null    object \n",
      " 7   Année                   428 non-null    int64  \n",
      " 8   Abs_nat_t1              428 non-null    float64\n",
      " 9   Abs_nat_t2              428 non-null    float64\n",
      " 10  Abs_nat                 428 non-null    float64\n",
      "dtypes: float64(7), int64(1), object(3)\n",
      "memory usage: 36.9+ KB\n"
     ]
    }
   ],
   "source": [
    "dep_abs.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "8a7d5bde",
   "metadata": {},
   "outputs": [],
   "source": [
    "stripped_virgule_t2 = dep_abs['% Abs/Ins_t2'].astype('str')\n",
    "stripped_virgule_t2 = stripped_virgule_t2.str.replace(',','.')\n",
    "dep_abs['% Abs/Ins_t2'] = stripped_virgule_t2.astype('float')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "563f4c9f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 428 entries, 0 to 427\n",
      "Data columns (total 11 columns):\n",
      " #   Column                  Non-Null Count  Dtype  \n",
      "---  ------                  --------------  -----  \n",
      " 0   Code du département     426 non-null    object \n",
      " 1   Libellé du département  426 non-null    object \n",
      " 2   Abstentions_t1          426 non-null    float64\n",
      " 3   % Abs/Ins_t1            426 non-null    float64\n",
      " 4   Inscrits                427 non-null    float64\n",
      " 5   Abstentions_t2          426 non-null    float64\n",
      " 6   % Abs/Ins_t2            426 non-null    float64\n",
      " 7   Année                   428 non-null    int64  \n",
      " 8   Abs_nat_t1              428 non-null    float64\n",
      " 9   Abs_nat_t2              428 non-null    float64\n",
      " 10  Abs_nat                 428 non-null    float64\n",
      "dtypes: float64(8), int64(1), object(2)\n",
      "memory usage: 36.9+ KB\n"
     ]
    }
   ],
   "source": [
    "dep_abs.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "8cd158fe",
   "metadata": {},
   "outputs": [],
   "source": [
    "dep_abs['% Abs/Ins'] = dep_abs[['% Abs/Ins_t1', '% Abs/Ins_t2']].mean(axis = 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "51a3b3d3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Code du département                 28\n",
       "Libellé du département    EURE ET LOIR\n",
       "Abstentions_t1                 72820.0\n",
       "% Abs/Ins_t1                     26.18\n",
       "Inscrits                      278123.0\n",
       "Abstentions_t2                 53703.0\n",
       "% Abs/Ins_t2                     19.32\n",
       "Année                             2002\n",
       "Abs_nat_t1                   14.199823\n",
       "Abs_nat_t2                   10.145453\n",
       "Abs_nat                      12.172638\n",
       "% Abs/Ins                        22.75\n",
       "Name: 426, dtype: object"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dep_abs.loc[426]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "b73f97d4",
   "metadata": {},
   "outputs": [],
   "source": [
    "dep_abs.drop(160, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "d4c6366f",
   "metadata": {},
   "outputs": [],
   "source": [
    "dep_abs.drop(427, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "085d8906",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Code du département</th>\n",
       "      <th>Libellé du département</th>\n",
       "      <th>Abstentions_t1</th>\n",
       "      <th>% Abs/Ins_t1</th>\n",
       "      <th>Inscrits</th>\n",
       "      <th>Abstentions_t2</th>\n",
       "      <th>% Abs/Ins_t2</th>\n",
       "      <th>Année</th>\n",
       "      <th>Abs_nat_t1</th>\n",
       "      <th>Abs_nat_t2</th>\n",
       "      <th>Abs_nat</th>\n",
       "      <th>% Abs/Ins</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Ain</td>\n",
       "      <td>81507.0</td>\n",
       "      <td>19.60</td>\n",
       "      <td>415886.0</td>\n",
       "      <td>93130.0</td>\n",
       "      <td>22.39</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "      <td>20.995</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>68</td>\n",
       "      <td>Haut-Rhin</td>\n",
       "      <td>110496.0</td>\n",
       "      <td>21.00</td>\n",
       "      <td>526190.0</td>\n",
       "      <td>128800.0</td>\n",
       "      <td>24.48</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "      <td>22.740</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>79</td>\n",
       "      <td>Deux-Sèvres</td>\n",
       "      <td>51156.0</td>\n",
       "      <td>18.78</td>\n",
       "      <td>272385.0</td>\n",
       "      <td>57585.0</td>\n",
       "      <td>21.14</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "      <td>19.960</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>78</td>\n",
       "      <td>Yvelines</td>\n",
       "      <td>177485.0</td>\n",
       "      <td>18.66</td>\n",
       "      <td>951148.0</td>\n",
       "      <td>225177.0</td>\n",
       "      <td>23.68</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "      <td>21.170</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>77</td>\n",
       "      <td>Seine-et-Marne</td>\n",
       "      <td>183302.0</td>\n",
       "      <td>20.79</td>\n",
       "      <td>881558.0</td>\n",
       "      <td>228009.0</td>\n",
       "      <td>25.88</td>\n",
       "      <td>2017</td>\n",
       "      <td>22.231967</td>\n",
       "      <td>25.432557</td>\n",
       "      <td>23.832262</td>\n",
       "      <td>23.335</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  Code du département Libellé du département  Abstentions_t1  % Abs/Ins_t1  \\\n",
       "0                   1                    Ain         81507.0         19.60   \n",
       "1                  68              Haut-Rhin        110496.0         21.00   \n",
       "2                  79            Deux-Sèvres         51156.0         18.78   \n",
       "3                  78               Yvelines        177485.0         18.66   \n",
       "4                  77         Seine-et-Marne        183302.0         20.79   \n",
       "\n",
       "   Inscrits  Abstentions_t2  % Abs/Ins_t2  Année  Abs_nat_t1  Abs_nat_t2  \\\n",
       "0  415886.0         93130.0         22.39   2017   22.231967   25.432557   \n",
       "1  526190.0        128800.0         24.48   2017   22.231967   25.432557   \n",
       "2  272385.0         57585.0         21.14   2017   22.231967   25.432557   \n",
       "3  951148.0        225177.0         23.68   2017   22.231967   25.432557   \n",
       "4  881558.0        228009.0         25.88   2017   22.231967   25.432557   \n",
       "\n",
       "     Abs_nat  % Abs/Ins  \n",
       "0  23.832262     20.995  \n",
       "1  23.832262     22.740  \n",
       "2  23.832262     19.960  \n",
       "3  23.832262     21.170  \n",
       "4  23.832262     23.335  "
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dep_abs.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3fd0765e",
   "metadata": {},
   "source": [
    "A faire pour la suite :\n",
    "- créer graphique introductif abstention national sur 5 ans (reste stable, comment l'augmenter ?)\n",
    "- créer carte introductive abstention territorial (les départements ne votent pas du tout autant. Conséquence --> l'île de France a un poids plus élevé que la Lozère dans l'éléction de leur dirigeant. Comment y remédier ?)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ef701b84",
   "metadata": {},
   "source": [
    "# II Première visualisation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "cf95e1e8",
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "80102121",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'x' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-41-c41b242cff79>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0mval_2017\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdep_abs\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'Abs_nat'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mdep_abs\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mdep_abs\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'Année'\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;36m2017\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mindex\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m \u001b[0mAbstention\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mval_2002\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mval_2007\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mval_2012\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mval_2017\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 7\u001b[0;31m \u001b[0mplt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mbar\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      8\u001b[0m \u001b[0mplt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mylabel\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'Abstention nationale en %'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      9\u001b[0m \u001b[0mplt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mxlabel\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'Année'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mNameError\u001b[0m: name 'x' is not defined"
     ]
    }
   ],
   "source": [
    "Année = ['2002', '2007', '2012', '2017']\n",
    "val_2002 = dep_abs['Abs_nat'][dep_abs[dep_abs['Année'] == 2002].index[0]]\n",
    "val_2007 = dep_abs['Abs_nat'][dep_abs[dep_abs['Année'] == 2007].index[0]]\n",
    "val_2012 = dep_abs['Abs_nat'][dep_abs[dep_abs['Année'] == 2012].index[0]]\n",
    "val_2017 = dep_abs['Abs_nat'][dep_abs[dep_abs['Année'] == 2017].index[0]]\n",
    "Abstention = [val_2002, val_2007, val_2012, val_2017]\n",
    "plt.bar(x, y)\n",
    "plt.ylabel('Abstention nationale en %')\n",
    "plt.xlabel('Année')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "ba616e3e",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0e9ff1aa",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
